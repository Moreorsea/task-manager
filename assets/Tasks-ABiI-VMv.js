import{_ as B,c as l,o,a as e,d as N,u as R,b as F,r as w,e as x,f as U,s as L,w as ce,n as T,g as S,h as ne,v as re,i as t,j as g,k as P,t as d,F as j,l as M,R as W,m as le,C as de,p as E,A as O,q as ie,x as D,I as z,y as _e,S as ue,z as ve,B as pe}from"./index-C0dfKrUU.js";import{C as he}from"./flatpickr-DpGQfQbp.js";const ke={},fe={class:"card__color-bar-wave",width:"100%",height:"10"};function me(i,s){return o(),l("svg",fe,s[0]||(s[0]=[e("g",{fill:"none","fill-rule":"nonzero","stroke-linecap":"square","stroke-width":"5",stroke:"current-color"},[e("path",{d:"M4 4l9.257 2.463L21.367 4l7.927 2.463L38.736 4l9.117 2.463L56.103 4l8.685 2.463L73.472 4l8.684 2.463L90.84 4l8.684 2.463L108.208 4l8.684 2.463L125.576 4l8.684 2.463L142.943 4M146.423 4l9.257 2.463"})],-1)]))}const Y=B(ke,[["render",me]]),ge={class:"card__form",method:"get"},be={class:"card__inner"},$e={class:"card__color-bar"},ye={class:"card__textarea-wrap"},Te=["placeholder"],Ce={class:"card__settings"},Se={class:"card__details"},we={class:"card__dates"},xe={class:"card__repeat-status"},Le={key:0,class:"card__repeat-days"},De={class:"card__repeat-days-inner"},je=["onClick"],Ne={class:"card__date-status"},Re={key:1,class:"card__date-deadline"},Ee={class:"card__colors-inner"},Me={class:"card__colors-title"},Oe={class:"card__colors-wrap"},Fe=["id","value","checked"],Ve=["for","onClick"],Ie={class:"error"},ze={class:"card__status-btns"},Be=N({__name:"Form",props:{task:{type:Object,required:!1}},setup(i){var q,A,H,K;const s=i,{t:c}=R(),_=F(),a=w(s.task||_.createNewTask()),u=w(Object.values(((q=a.value)==null?void 0:q.repeating_date)||{}).some(r=>r)),k=x(()=>u.value?"yes":"no"),v=w(!!((A=a.value)!=null&&A.due_date)),C=x(()=>v.value?"yes":"no"),f=w(""),b=w((H=s.task)!=null&&H.due_date?new Date((K=s.task)==null?void 0:K.due_date).getTime():new Date().getTime()),$=U(),{currentLanguage:V}=L($),p=w({dateFormat:"M d, Y"}),{tasksListState:h}=L(_),y=x(()=>{const r=[];return r.push(`card--${a.value.color}`),u.value&&r.push("card--repeat"),r.join(" ")}),J=()=>{var m;const r=[];a.value.description||r.push(c("errors.errorTaskNoName")),u.value&&!Object.values((m=a.value)==null?void 0:m.repeating_date).some(n=>n)&&r.push(c("errors.errorTaskNoRepeat")),f.value=r.join(`
`)},Q=()=>{J(),f.value||_.createEditTask({...a.value,due_date:v.value?b.value:null},a.value.id?O.put:O.post)},X=r=>{b.value=new Date(r[0]).getTime()},Z=()=>{_.deleteTask(a.value.id)},ee=()=>{_.setTasksListState(void 0)};ce(()=>{var r;a.value.description&&(f.value=""),u.value&&Object.values((r=a.value)==null?void 0:r.repeating_date).some(m=>m)&&(f.value="")});const te=r=>{a.value.color=r},se=r=>{a.value.repeating_date[r]=!a.value.repeating_date[r]},ae=()=>{u.value=!u.value,u.value?(v.value=!1,a.value.due_date=null):a.value.repeating_date={mo:!1,tu:!1,we:!1,th:!1,fr:!1,sa:!1,su:!1}},oe=()=>{v.value=!v.value};return(r,m)=>(o(),l("article",{class:T(["card card--edit",y.value])},[e("form",ge,[e("div",be,[e("div",$e,[S(Y)]),e("div",ye,[e("label",null,[ne(e("textarea",{"onUpdate:modelValue":m[0]||(m[0]=n=>a.value.description=n),class:"card__text",placeholder:t(c)("form.placeholder"),minlength:"1",maxlength:"120",name:"text"},null,8,Te),[[re,a.value.description]])])]),e("div",Ce,[e("div",Se,[e("div",we,[e("button",{class:"card__repeat-toggle",type:"button",onClick:ae},[P(d(t(c)("form.repeat")),1),e("span",xe,d(t(c)(`form.${k.value}`)),1)]),u.value?(o(),l("fieldset",Le,[e("ul",De,[(o(!0),l(j,null,M(t(le),n=>{var I;return o(),l("li",{key:n,class:T(["card__repeat-days-item",{"card__repeat-days-item--active":(I=a.value)==null?void 0:I.repeating_date[n]}]),onClick:lt=>se(n)},d(t(V)==="en"?n:t(W)[n]),11,je)}),128))])])):g("",!0),e("button",{class:"card__date-deadline-toggle",type:"button",onClick:oe},[P(d(t(c)("form.date"))+" ",1),e("span",Ne,d(t(c)(`form.${C.value}`)),1)]),v.value?(o(),l("fieldset",Re,[S(t(he),{modelValue:b.value,"onUpdate:modelValue":m[1]||(m[1]=n=>b.value=n),config:p.value,class:"card__date","onOn-сlose":X},null,8,["modelValue","config"])])):g("",!0)])]),e("div",Ee,[e("h3",Me,d(t(c)("form.color")),1),e("ul",Oe,[(o(!0),l(j,null,M(t(de),n=>(o(),l("li",{key:n},[e("input",{id:`color-${n}-4`,type:"radio",class:T(`card__color-input card__color-input--${n} visually-hidden`),name:"color",value:`${n}`,checked:a.value.color===n},null,10,Fe),e("label",{for:`color-${n}-4`,class:T(`card__color card__color--${n}`),onClick:I=>te(n)},d(n),11,Ve)]))),128))])])]),e("p",Ie,d(f.value),1),e("div",ze,[e("button",{class:"card__button card__button--save",type:"submit",onClick:E(Q,["prevent"])},d(t(c)("form.save")),1),e("button",{class:"card__button card__button--cancel",onClick:E(ee,["prevent"])},d(t(c)("form.cancel")),1),t(h)!==null?(o(),l("button",{key:0,class:"card__button card__button--delete",onClick:E(Z,["prevent"])},d(t(c)("form.delete")),1)):g("",!0)])])])],2))}}),G=B(Be,[["__scopeId","data-v-2ad71aaa"]]),qe={class:"card__form"},Ae={class:"card__inner"},He={class:"card__control"},Ke={class:"card__color-bar"},Pe={class:"card__textarea-wrap"},Ue={class:"card__text"},We={key:0,class:"card__days"},Ye={key:1,class:"card__settings"},Ge={class:"card__details"},Je={class:"card__dates"},Qe={class:"card__date-deadline"},Xe={class:"card__input-deadline-wrap"},Ze={class:"card__date"},et=N({__name:"TaskCard",props:{task:{type:Object,required:!0}},setup(i){const s=i,{t:c}=R(),_=p=>Object.values(p).some(h=>h),a=U(),{currentLanguage:u}=L(a),k=x(()=>{var p;return Object.entries((p=s.task)==null?void 0:p.repeating_date).reduce((h,y)=>(y[1]&&(u.value==="ru"?h.push(W[y[0]]):h.push(y[0])),h),[]).join(", ")}),v=F(),{tasksListState:C}=L(v),f=x(()=>{var h;const p=["card"];return s.task.color&&p.push(`card--${s.task.color}`),_((h=s.task)==null?void 0:h.repeating_date)&&p.push("card--repeat"),s.task.due_date&&ie(s.task.due_date)&&p.push("card--deadline"),C.value&&C.value===s.task.id&&p.push("card--edit"),p.join(" ")}),b=()=>{v.setTasksListState(s.task.id)},$=()=>{v.createEditTask({...s.task,is_favorite:!s.task.is_favorite},O.put)},V=()=>{v.createEditTask({...s.task,is_archived:!s.task.is_archived},O.put)};return(p,h)=>{var y;return t(C)&&t(C)===i.task.id?(o(),D(G,{key:0,task:{...i.task}},null,8,["task"])):(o(),l("article",{key:1,class:T(f.value)},[e("div",qe,[e("div",Ae,[e("div",He,[S(t(z),{icon:"line-md:edit",width:"24",height:"24",class:"card__btn card__btn--edit",onClick:b}),S(t(z),{icon:"line-md:folder-check",width:"24",class:T({"card__btn card__btn--archive":!0,"card__btn--disabled":i.task.is_archived}),height:"24",onClick:V},null,8,["class"]),S(t(z),{icon:"line-md:heart",width:"24",height:"24",onClick:$,class:T({"card__btn card__btn--favorites":!0,"card__btn--disabled":i.task.is_favorite})},null,8,["class"])]),e("div",Ke,[S(Y)]),e("div",Pe,[e("p",Ue,d(i.task.description),1)]),_((y=s.task)==null?void 0:y.repeating_date)?(o(),l("div",We,d(t(c)("tasks.repetitionDays",{days:k.value})),1)):g("",!0),i.task.due_date?(o(),l("div",Ye,[e("div",Ge,[e("div",Je,[e("div",Qe,[e("p",Xe,[e("span",Ze,d(t(_e)(i.task.due_date,t(u))),1)])])])])])):g("",!0)])])],2))}}}),tt={class:"board__filter-list"},st=["onClick"],at=N({__name:"HeaderSort",setup(i){const{t:s}=R(),c=F(),{activeSort:_}=L(c);return(a,u)=>(o(),l("nav",null,[e("ul",tt,[(o(!0),l(j,null,M(t(ue),k=>(o(),l("li",{key:k},[e("button",{class:T(["board__filter",{"board__filter--active":t(_)===k}]),onClick:E(v=>t(c).setActiveSort(k),["prevent"])},d(t(s)(`sorts.${k}`)),11,st)]))),128))])]))}}),ot=B(at,[["__scopeId","data-v-0c9f0490"]]),ct={class:"board__no-tasks"},nt=N({__name:"NoTasks",setup(i){const{t:s}=R();return(c,_)=>(o(),l("p",ct,d(t(s)("tasks.noTasks")),1))}}),rt={class:"board__tasks"},_t=N({__name:"Tasks",setup(i){const{t:s}=R(),c=F(),{tasksListState:_,paginatedTasks:a,isShowLoadMore:u}=L(c),k=x(()=>a.value.length===0&&_.value===void 0),v=()=>{c.setTasksListState(void 0)};return(C,f)=>{const b=pe("notifications");return o(),l(j,null,[e("section",{class:"board container",onKeyup:ve(v,["esc"])},[t(a).length?(o(),D(ot,{key:0})):g("",!0),e("div",rt,[t(_)===null?(o(),D(G,{key:0})):g("",!0),k.value?(o(),D(nt,{key:1})):g("",!0),(o(!0),l(j,null,M(t(a),$=>(o(),D(et,{key:$.id,task:$},null,8,["task"]))),128))]),t(u)?(o(),l("button",{key:1,class:"load-more",type:"button",onClick:f[0]||(f[0]=(...$)=>t(c).updatePageSize&&t(c).updatePageSize(...$))},d(t(s)("tasks.loadMore")),1)):g("",!0)],32),S(b,{position:"top right"})],64)}}});export{_t as default};
